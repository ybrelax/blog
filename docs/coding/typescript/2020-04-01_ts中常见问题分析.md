---
category: 编程
tags:
  - vue
date: 2020-03-30
title: ts 常见问题分析
---


## Typescript 见问题分析

### module => namespace

新版本中推荐我们用 namespace 来代替 module

module: 
```ts
module Person {
    export xxx
}
```
namespace:
```ts
module Person {
    export xxx
}
···

### never、undefined、void

* null 和 undefined 是其他类型的（包括void)的子类型，可以赋值给其他类型的

* 默认情况下，编译器会提示错误，这是因为 tsconfig.json 里面有一个配置项是默认开启的。
```json
// tsconfig
{
  "strict": true // 可以关闭这个严格模式
}
```

* never 表示一个不包含值得类型，即不存在

### 元组越界

```ts

let x: [string, number] = ['ybrelax', 10];

x.push(5);

console.log('x:', x);

// error tip: Tuple type '[string, number]' of length '2' has no element at index '2'
console.log(x[0],x[1], x[2])

```

### 枚举成员得特点
* 只读属性，无法修改
* 枚举成员默认从0开始递增，也可以改变初始值
* 可以设置表达式，但是不能数字和其他类型同在一个枚举对象里
* 可以引用其他枚举得变量 ， 但是枚举对象只能有一个类型声明
```ts

enum Gender {
    a = 1,
    b,
    c = Gender.a,
    
    // 单一类型
    body = 'xx',
    girl = '1'
}

console.log(Gender.body);
console.log(Gender);
```

* 使用场景，可以去除一些硬编码操作
```ts
// 使用场景

enum Role {
    superAdmin,
    admin,
    normal
}

function switchRole(role: number) {
    switch(role) {
        case Role.superAdmin: // 1
         console.log('超级管理员');
         break;
         case Role.admin: //2
            console.log("管理员");
            break;
        default: 
            console.log('一般用户');
            break
    }
}
switchRole(1)
```

### 可索引类型接口

* 约束数组和对象
```ts
interface StringArray {
    // index 类型为number, 一般都表示数组
    [index:number]:string
}

let arr:StringArray = ['aaa', 'bbb'];
console.log(arr)

interface stringObject {
    // index 类型为string, 一般都表示为对象
    [index:string]:string
}

let obj:stringObject = {name: 'cccc'}
```

### 函数类型接口
* 对传入的参数和返回值进行约束

```ts
interface discount2 {
    // ":" 前面是用来约束函数参数
    // ":" 后面是用来约束函数的返回值
    (price:number): number
}

let cost:discount2 = function(price:number) {
    return price * 8;
}
```

### 错误信息：can only be default-imported using the 'esModuleInterop' flag"
错误原因：需要在 tsconfig.json 文件中添加 "esModuleInterop": true,;
解释：Enables emit interoperability between CommonJS and ES Modules via creation of namespace objects for all imports. Implies 'allowSyntheticDefaultImports'.
参考文档：https://www.typescriptlang.org/v2/docs/handbook/release-notes/typescript-2-7.html
